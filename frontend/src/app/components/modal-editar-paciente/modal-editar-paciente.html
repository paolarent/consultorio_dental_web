<div class="fixed inset-0 bg-black/40 flex justify-center items-center z-50">
    <div class="bg-white p-6 rounded-xl w-3/4 max-w-3xl max-h-[90vh] overflow-y-auto">
        <h2 class="text-3xl font-bold mt-2 mb-6 text-[#105053]">
            {{ step === 1 ? 'Editar mis datos' : 'Editar dirección' }}
        </h2>

        <!-- STEP 1: Datos personales + tutor -->
        @if(step === 1) {
            <div class="grid grid-cols-2 gap-6">
                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Nombre</label>
                    <input
                    type="text"
                    [value]="paciente.nombre"
                    placeholder="Ingresa tu nombre"
                    class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                    (input)="actualizarCampo($event, 'nombre')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Apellido Paterno</label>
                    <input
                    type="text"
                    [value]="paciente.apellido1"
                    placeholder="Ingresa tu primer apellido"
                    class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                    (input)="actualizarCampo($event, 'apellido1')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Apellido Materno</label>
                    <input
                    type="text"
                    [value]="paciente.apellido2"
                    placeholder="Ingresa tu segundo apellido"
                    class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                    (input)="actualizarCampo($event, 'apellido2')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Teléfono</label>
                    <input
                    type="text"
                    [value]="paciente.telefono"
                    placeholder="Ingresa tu teléfono"
                    class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                    (input)="actualizarCampo($event, 'telefono')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">
                        Fecha de nacimiento
                    </label>

                    <div>
                        <input
                            #fechaInput
                            type="text"
                            placeholder="Selecciona la fecha de nacimiento"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        />
                    </div>
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Sexo</label>

                    <mat-form-field appearance="outline" class="w-full">
                        <mat-select
                        [(value)]="paciente.sexo"
                        (selectionChange)="actualizarCampo($event.value, 'sexo')"
                        
                        >
                        <mat-option value="M">Masculino</mat-option>
                        <mat-option value="F">Femenino</mat-option>
                        <mat-option value="O">Otro</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>


            </div>

            <!-- Toggle tutor -->
            <div class="flex items-center mt-0 mb-6">
                <span class="mr-2 text-[#545454] font-bold">¿Tiene tutor?</span>
                <img [src]="tieneTutor ? 'assets/icons/on_switch.svg' : 'assets/icons/off_switch.svg'"
                    class="w-12 h-10 cursor-pointer" (click)="toggleTutor()"
                />
            </div>

            <!-- Datos tutor -->
            @if(tieneTutor) {
                <div class="grid grid-cols-2 gap-6 mt-4 mb-10">
                    <div>
                        <label class="block text-base font-medium text-[#545454] mb-1">Nombre de Tutor</label>
                        <input
                            type="text"
                            [value]="paciente.tutor_nombre"
                            placeholder="Nombre tutor"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                            (input)="actualizarCampo($event, 'tutor_nombre')"
                        />
                    </div>
                    
                    <div>
                        <label class="block text-base font-medium text-[#545454] mb-1">Apellido Paterno de Tutor</label>
                        <input
                            type="text"
                            [value]="paciente.tutor_apellido1"
                            placeholder="Apellido1 tutor"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                            (input)="actualizarCampo($event, 'tutor_apellido1')"
                        />
                    </div>

                    <div>
                        <label class="block text-base font-medium text-[#545454] mb-1">Apellido Materno de Tutor</label>
                        <input
                            type="text"
                            [value]="paciente.tutor_apellido2"
                            placeholder="Apellido2 tutor"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                            (input)="actualizarCampo($event, 'tutor_apellido2')"
                        />
                    </div>
                    
                    <div>
                        <label class="block text-base font-medium text-[#545454] mb-1">Teléfono Tutor</label>
                        <input
                            type="text"
                            [value]="paciente.tutor_telefono"
                            placeholder="Teléfono tutor"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                            (input)="actualizarCampo($event, 'tutor_telefono')"
                        />
                    </div>
                
                    <div>
                        <label class="block text-base font-medium text-[#545454] mb-1">Correo tutor</label>
                        <input
                            type="email"
                            [value]="paciente.tutor_correo"
                            placeholder="Correo tutor"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                            (input)="actualizarCampo($event, 'tutor_correo')"
                        />
                    </div>
                    
                    <div>
                        <label class="block text-base font-medium text-[#545454] mb-1">Relación</label>
                        <input
                            type="text"
                            [value]="paciente.tutor_relacion"
                            placeholder="Relación"
                            class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                            (input)="actualizarCampo($event, 'tutor_relacion')"
                        />
                    </div>
                    
                </div>
            }

            <div class="flex justify-end gap-4 mt-6">
                <button
                    class="px-6 py-2 bg-neutral-600 rounded-lg inline-flex justify-center items-center cursor-pointer hover:bg-[#9C9898]"
                    (click)="cancelar()"
                >
                    <span class="text-center text-white text-lg font-semibold tracking-wider">Cancelar</span>
                </button>
                
                <button
                    class="px-6 py-2 bg-[#1D8E92] rounded-lg inline-flex justify-center items-center cursor-pointer hover:bg-[#105053]"
                    (click)="siguienteStep()"
                >
                    <span class="text-center text-white text-lg font-semibold tracking-wider">Siguiente</span>
                </button>
            </div>
        }

        <!-- STEP 2: Datos de direccion -->
        @if(step === 2) {
            <div class="grid grid-cols-2 gap-6">
                <!-- campos de dirección -->

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Calle</label>
                    <input
                        type="text"
                        [value]="paciente.d_calle"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_calle')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Núm. Exterior</label>
                    <input
                        type="text"
                        [value]="paciente.d_num_exterior"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_num_exterior')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Colonia</label>
                    <input
                        type="text"
                        [value]="paciente.d_colonia"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_colonia')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Código Póstal</label>
                    <input
                        type="text"
                        [value]="paciente.d_cp"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_cp')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Entidad Federativa</label>
                    <input
                        type="text"
                        [value]="paciente.d_entidadfed"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_entidadfed')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Municipio</label>
                    <input
                        type="text"
                        [value]="paciente.d_municipio"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_municipio')"
                    />
                </div>

                <div>
                    <label class="block text-base font-medium text-[#545454] mb-1">Localidad</label>
                    <input
                        type="text"
                        [value]="paciente.d_localidad"
                        placeholder="Ingresa la calle"
                        class="w-full h-12 border border-teal-600 bg-zinc-300/30 rounded-lg p-2 pl-3 focus:ring-2 focus:ring-[#545454] focus:outline-none"
                        (input)="actualizarCampo($event, 'd_localidad')"
                    />
                </div>

            </div>

            <div class="flex justify-end gap-4 mt-6">
                <button
                    class="px-6 py-2 bg-neutral-600 rounded-lg inline-flex justify-center items-center cursor-pointer hover:bg-[#9C9898]"
                    (click)="volverStep()"
                >
                    <span class="text-center text-white text-lg font-semibold tracking-wider">Volver</span>
                </button>
                
                <button
                    class="px-6 py-2 bg-[#1D8E92] rounded-lg inline-flex justify-center items-center cursor-pointer hover:bg-[#105053]"
                    (click)="guardarCambios()"
                >
                    <span class="text-center text-white text-lg font-semibold tracking-wider">Guardar cambios</span>
                </button>
            </div>
        }

    </div>
</div>


